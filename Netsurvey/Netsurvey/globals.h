#include "Options.h"
#include "Scanner.h"
#include "AbstractIPStyle.h"
#include "afxdialogex.h"
#include <string.h>

UINT ThreadProcCallback(LPVOID nParam);
UINT ThreadProcCallbackRescan(LPVOID nParam);
UINT ScanningThread(DWORD nParam, BOOL bParameterIsIP);

#define MAX_THREAD_COUNT	1000
#define THREAD_DEAD			0		// constants to be used with g_threads array
#define THREAD_MUST_DIE		1
#define THREAD_ALIVE		2

#define SCAN_MODE_NOT_SCANNING	0
#define SCAN_MODE_SCANNING		1
#define SCAN_MODE_FINISHING		2
#define SCAN_MODE_KILLING		3

#define INDEX_CONTEXT_MENU	2
#define INDEX_FAVOURITES_MENU	3
#define	INDEX_SHOW_MENU		4
#define	INDEX_OPEN_MENU		5

extern UINT g_nThreadCount;
extern int g_threads[MAX_THREAD_COUNT + 1];	// +1 is for safety :-)
extern CDialogEx * g_dlg;
extern CScanner * g_scanner;
extern COptions * g_options;
extern CAbstractIPStyle * g_pIPStyle;
extern CRITICAL_SECTION g_criticalSection;

#define ID_MENU_FAVOURITES_001          33001
#define ID_MENU_FAVOURITES_002          33002
#define ID_MENU_FAVOURITES_003          33003
#define ID_MENU_FAVOURITES_004          33004
#define ID_MENU_FAVOURITES_005          33005
#define ID_MENU_FAVOURITES_006          33006
#define ID_MENU_FAVOURITES_007          33007
#define ID_MENU_FAVOURITES_008          33008
#define ID_MENU_FAVOURITES_009          33009
#define ID_MENU_FAVOURITES_010          33010
#define ID_MENU_FAVOURITES_011          33011
#define ID_MENU_FAVOURITES_012          33012
#define ID_MENU_FAVOURITES_013          33013
#define ID_MENU_FAVOURITES_014          33014
#define ID_MENU_FAVOURITES_015          33015
#define ID_MENU_FAVOURITES_016          33016
#define ID_MENU_FAVOURITES_017          33017
#define ID_MENU_FAVOURITES_018          33018
#define ID_MENU_FAVOURITES_019          33019
#define ID_MENU_FAVOURITES_020          33020
#define ID_MENU_FAVOURITES_021          33021
#define ID_MENU_FAVOURITES_022          33022
#define ID_MENU_FAVOURITES_023          33023
#define ID_MENU_FAVOURITES_024          33024
#define ID_MENU_FAVOURITES_025          33025
#define ID_MENU_FAVOURITES_026          33026
#define ID_MENU_FAVOURITES_027          33027
#define ID_MENU_FAVOURITES_028          33028
#define ID_MENU_FAVOURITES_029          33029
#define ID_MENU_FAVOURITES_030          33030
#define ID_MENU_FAVOURITES_031          33031
#define ID_MENU_FAVOURITES_032          33032
#define ID_MENU_FAVOURITES_033          33033
#define ID_MENU_FAVOURITES_034          33034
#define ID_MENU_FAVOURITES_035          33035
#define ID_MENU_FAVOURITES_036          33036
#define ID_MENU_FAVOURITES_037          33037
#define ID_MENU_FAVOURITES_038          33038
#define ID_MENU_FAVOURITES_039          33039
#define ID_MENU_FAVOURITES_040          33040
#define ID_MENU_FAVOURITES_041          33041
#define ID_MENU_FAVOURITES_042          33042
#define ID_MENU_FAVOURITES_043          33043
#define ID_MENU_FAVOURITES_044          33044
#define ID_MENU_FAVOURITES_045          33045
#define ID_MENU_FAVOURITES_046          33046
#define ID_MENU_FAVOURITES_047          33047
#define ID_MENU_FAVOURITES_048          33048
#define ID_MENU_FAVOURITES_049          33049
#define ID_MENU_FAVOURITES_050          33050
#define ID_MENU_FAVOURITES_051          33051
#define ID_MENU_FAVOURITES_052          33052
#define ID_MENU_FAVOURITES_053          33053
#define ID_MENU_FAVOURITES_054          33054
#define ID_MENU_FAVOURITES_055          33055
#define ID_MENU_FAVOURITES_056          33056
#define ID_MENU_FAVOURITES_057          33057
#define ID_MENU_FAVOURITES_058          33058
#define ID_MENU_FAVOURITES_059          33059
#define ID_MENU_FAVOURITES_060          33060
#define ID_MENU_FAVOURITES_061          33061
#define ID_MENU_FAVOURITES_062          33062
#define ID_MENU_FAVOURITES_063          33063
#define ID_MENU_FAVOURITES_064          33064
#define ID_MENU_FAVOURITES_065          33065
#define ID_MENU_FAVOURITES_066          33066
#define ID_MENU_FAVOURITES_067          33067
#define ID_MENU_FAVOURITES_068          33068
#define ID_MENU_FAVOURITES_069          33069
#define ID_MENU_FAVOURITES_070          33070
#define ID_MENU_FAVOURITES_071          33071
#define ID_MENU_FAVOURITES_072          33072
#define ID_MENU_FAVOURITES_073          33073
#define ID_MENU_FAVOURITES_074          33074
#define ID_MENU_FAVOURITES_075          33075
#define ID_MENU_FAVOURITES_076          33076
#define ID_MENU_FAVOURITES_077          33077
#define ID_MENU_FAVOURITES_078          33078
#define ID_MENU_FAVOURITES_079          33079
#define ID_MENU_FAVOURITES_080          33080
#define ID_MENU_FAVOURITES_081          33081
#define ID_MENU_FAVOURITES_082          33082
#define ID_MENU_FAVOURITES_083          33083
#define ID_MENU_FAVOURITES_084          33084
#define ID_MENU_FAVOURITES_085          33085
#define ID_MENU_FAVOURITES_086          33086
#define ID_MENU_FAVOURITES_087          33087
#define ID_MENU_FAVOURITES_088          33088
#define ID_MENU_FAVOURITES_089          33089
#define ID_MENU_FAVOURITES_090          33090
#define ID_MENU_FAVOURITES_091          33091
#define ID_MENU_FAVOURITES_092          33092
#define ID_MENU_FAVOURITES_093          33093
#define ID_MENU_FAVOURITES_094          33094
#define ID_MENU_FAVOURITES_095          33095
#define ID_MENU_FAVOURITES_096          33096
#define ID_MENU_FAVOURITES_097          33097
#define ID_MENU_FAVOURITES_098          33098
#define ID_MENU_FAVOURITES_099          33099
#define ID_MENU_FAVOURITES_100          33100
#define ID_MENU_FAVOURITES_101          33101
#define ID_MENU_FAVOURITES_102          33102
#define ID_MENU_FAVOURITES_103          33103
#define ID_MENU_FAVOURITES_104          33104
#define ID_MENU_FAVOURITES_105          33105
#define ID_MENU_FAVOURITES_106          33106
#define ID_MENU_FAVOURITES_107          33107
#define ID_MENU_FAVOURITES_108          33108
#define ID_MENU_FAVOURITES_109          33109
#define ID_MENU_FAVOURITES_110          33110
#define ID_MENU_FAVOURITES_111          33111
#define ID_MENU_FAVOURITES_112          33112
#define ID_MENU_FAVOURITES_113          33113
#define ID_MENU_FAVOURITES_114          33114
#define ID_MENU_FAVOURITES_115          33115
#define ID_MENU_FAVOURITES_116          33116
#define ID_MENU_FAVOURITES_117          33117
#define ID_MENU_FAVOURITES_118          33118
#define ID_MENU_FAVOURITES_119          33119
#define ID_MENU_FAVOURITES_120          33120
#define ID_MENU_FAVOURITES_121          33121
#define ID_MENU_FAVOURITES_122          33122
#define ID_MENU_FAVOURITES_123          33123
#define ID_MENU_FAVOURITES_124          33124
#define ID_MENU_FAVOURITES_125          33125
#define ID_MENU_FAVOURITES_126          33126
#define ID_MENU_FAVOURITES_127          33127
#define ID_MENU_FAVOURITES_128          33128
#define ID_MENU_FAVOURITES_129          33129
#define ID_MENU_FAVOURITES_130          33130
#define ID_MENU_FAVOURITES_131          33131
#define ID_MENU_FAVOURITES_132          33132
#define ID_MENU_FAVOURITES_133          33133
#define ID_MENU_FAVOURITES_134          33134
#define ID_MENU_FAVOURITES_135          33135
#define ID_MENU_FAVOURITES_136          33136
#define ID_MENU_FAVOURITES_137          33137
#define ID_MENU_FAVOURITES_138          33138
#define ID_MENU_FAVOURITES_139          33139
#define ID_MENU_FAVOURITES_141          33141
#define ID_MENU_FAVOURITES_142          33142
#define ID_MENU_FAVOURITES_143          33143
#define ID_MENU_FAVOURITES_144          33144
#define ID_MENU_FAVOURITES_145          33145
#define ID_MENU_FAVOURITES_146          33146
#define ID_MENU_FAVOURITES_147          33147
#define ID_MENU_FAVOURITES_148          33148
#define ID_MENU_FAVOURITES_149          33149
#define ID_MENU_FAVOURITES_150          33150
#define ID_MENU_FAVOURITES_151          33151
#define ID_MENU_FAVOURITES_152          33152
#define ID_MENU_FAVOURITES_153          33153
#define ID_MENU_FAVOURITES_154          33154
#define ID_MENU_FAVOURITES_155          33155
#define ID_MENU_FAVOURITES_156          33156
#define ID_MENU_FAVOURITES_157          33157
#define ID_MENU_FAVOURITES_158          33158
#define ID_MENU_FAVOURITES_159          33159
#define ID_MENU_FAVOURITES_160          33160
#define ID_MENU_FAVOURITES_161          33161
#define ID_MENU_FAVOURITES_162          33162
#define ID_MENU_FAVOURITES_163          33163
#define ID_MENU_FAVOURITES_164          33164
#define ID_MENU_FAVOURITES_165          33165
#define ID_MENU_FAVOURITES_166          33166
#define ID_MENU_FAVOURITES_167          33167
#define ID_MENU_FAVOURITES_168          33168
#define ID_MENU_FAVOURITES_169          33169
#define ID_MENU_FAVOURITES_170          33170
#define ID_MENU_FAVOURITES_171          33171
#define ID_MENU_FAVOURITES_172          33172
#define ID_MENU_FAVOURITES_173          33173
#define ID_MENU_FAVOURITES_174          33174
#define ID_MENU_FAVOURITES_175          33175
#define ID_MENU_FAVOURITES_176          33176
#define ID_MENU_FAVOURITES_177          33177
#define ID_MENU_FAVOURITES_178          33178
#define ID_MENU_FAVOURITES_179          33179
#define ID_MENU_FAVOURITES_180          33180
#define ID_MENU_FAVOURITES_181          33181
#define ID_MENU_FAVOURITES_182          33182
#define ID_MENU_FAVOURITES_183          33183
#define ID_MENU_FAVOURITES_184          33184
#define ID_MENU_FAVOURITES_185          33185
#define ID_MENU_FAVOURITES_186          33186
#define ID_MENU_FAVOURITES_187          33187
#define ID_MENU_FAVOURITES_188          33188
#define ID_MENU_FAVOURITES_189          33189
#define ID_MENU_FAVOURITES_190          33190
#define ID_MENU_FAVOURITES_191          33191
#define ID_MENU_FAVOURITES_192          33192
#define ID_MENU_FAVOURITES_193          33193
#define ID_MENU_FAVOURITES_194          33194
#define ID_MENU_FAVOURITES_195          33195
#define ID_MENU_FAVOURITES_196          33196
#define ID_MENU_FAVOURITES_197          33197
#define ID_MENU_FAVOURITES_198          33198
#define ID_MENU_FAVOURITES_199          33199
#define ID_MENU_FAVOURITES_200          33200
#define ID_MENU_FAVOURITES_201          33201
#define ID_MENU_FAVOURITES_202          33202
#define ID_MENU_FAVOURITES_203          33203
#define ID_MENU_FAVOURITES_204          33204
#define ID_MENU_FAVOURITES_205          33205
#define ID_MENU_FAVOURITES_206          33206
#define ID_MENU_FAVOURITES_207          33207
#define ID_MENU_FAVOURITES_208          33208
#define ID_MENU_FAVOURITES_209          33209
#define ID_MENU_FAVOURITES_210          33210
#define ID_MENU_FAVOURITES_211          33211
#define ID_MENU_FAVOURITES_212          33212
#define ID_MENU_FAVOURITES_213          33213
#define ID_MENU_FAVOURITES_214          33214
#define ID_MENU_FAVOURITES_215          33215
#define ID_MENU_FAVOURITES_216          33216
#define ID_MENU_FAVOURITES_217          33217
#define ID_MENU_FAVOURITES_218          33218
#define ID_MENU_FAVOURITES_219          33219
#define ID_MENU_FAVOURITES_220          33220
#define ID_MENU_FAVOURITES_221          33221
#define ID_MENU_FAVOURITES_222          33222
#define ID_MENU_FAVOURITES_223          33223
#define ID_MENU_FAVOURITES_224          33224
#define ID_MENU_FAVOURITES_225          33225
#define ID_MENU_FAVOURITES_226          33226
#define ID_MENU_FAVOURITES_227          33227
#define ID_MENU_FAVOURITES_228          33228
#define ID_MENU_FAVOURITES_229          33229
#define ID_MENU_FAVOURITES_230          33230
#define ID_MENU_FAVOURITES_231          33231
#define ID_MENU_FAVOURITES_232          33232
#define ID_MENU_FAVOURITES_233          33233
#define ID_MENU_FAVOURITES_234          33234
#define ID_MENU_FAVOURITES_235          33235
#define ID_MENU_FAVOURITES_236          33236
#define ID_MENU_FAVOURITES_237          33237
#define ID_MENU_FAVOURITES_238          33238
#define ID_MENU_FAVOURITES_239          33239
#define ID_MENU_FAVOURITES_240          33240
#define ID_MENU_FAVOURITES_241          33241
#define ID_MENU_FAVOURITES_242          33242
#define ID_MENU_FAVOURITES_243          33243
#define ID_MENU_FAVOURITES_244          33244
#define ID_MENU_FAVOURITES_245          33245
#define ID_MENU_FAVOURITES_246          33246
#define ID_MENU_FAVOURITES_247          33247
#define ID_MENU_FAVOURITES_248          33248
#define ID_MENU_FAVOURITES_249          33249
